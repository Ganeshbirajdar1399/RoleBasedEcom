<div class="container">
  <h2>All Orders</h2>

  <div class="d-flex justify-content-between d-none d-md-block">
    <div class="w-auto">
      <input
        type="text"
        class="form-control"
        placeholder="Search Product with Name/Brand"
        [(ngModel)]="searchText"
      />
    </div>
    <div class="w-auto mt-2">
      <select class="form-select form-select-sm" [(ngModel)]="itemsPerPage">
        <option
          selected
          class="text-primary"
          *ngFor="let count of [15, 10, 5]"
          [value]="count"
        >
          {{ count }}
        </option>
      </select>
    </div>
  </div>

  <div class="container table-responsive">
    <table class="product-table table-bordered">
      <thead>
        <tr>
          <th>Order ID</th>
          <th>Customer Name</th>
          <th>Email</th>
          <th>Contact No.</th>
          <th>Shipping Address</th>
          <th>Billing Address</th>
          <th>Order Date</th>
          <th>Total Amount</th>
          <th>Items</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr
          *ngFor="
            let order of allOrders
              | paginate : { itemsPerPage: itemsPerPage, currentPage: page }
              | searchProduct : searchText : 'pname' : 'brand';
            let i = index
          "
        >
          <td>{{ order.id }}</td>
          <td>{{ order.customer.name }}</td>
          <td>{{ order.customer.email }}</td>
          <td>{{ order.customer.contactNo }}</td>
          <td>{{ order.customer.address }}</td>
          <td>{{ order.customer.billingAddress }}</td>
          <td>{{ order.orderDate | date : "short" }}</td>
          <td>{{ order.totalAmount | currency : "INR" }}</td>
          <td>
            <ul>
              <li *ngFor="let item of order.items">
                {{ item.pname }} ({{ item.ram }}, {{ item.disksize }}) x
                {{ item.quantity }} - {{ item.psp | currency : "INR" }}
              </li>
            </ul>
          </td>
          <td>
            <div class="d-flex justify-content-between">
              <!-- <button class="btn btn-sm btn-primary" (click)="editOrder(order)">
                <i class="bi bi-pencil-square"></i>
              </button> -->
              <button
                *ngIf="loggedInUser?.role === 'admin'"
                class="btn btn-sm btn-danger ms-2"
                (click)="deleteOrders(order.id)"
              >
                <i class="bi bi-trash"></i>
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
    <div class="pagination d-none d-md-block">
      <pagination-controls (pageChange)="page = $event"></pagination-controls>
    </div>
  </div>

  <!-- Mobile-friendly cards for small screens -->
  <div class="product-cards">
    <div class="card">
      <div class="card-body" *ngFor="let order of allOrders">
        <h5 class="card-title">Customer Name: {{ order.customer.name }}</h5>
        <p class="card-text">
          <strong>Customer Number:</strong> {{ order.customer.contactNo }}
        </p>
        <p class="card-text">
          <strong>Customer Email:</strong> {{ order.customer.email }}
        </p>
        <p class="card-text">
          <strong>Order Date: </strong> {{ order.orderDate | date : "short" }}
        </p>
        <p class="card-text">
          <strong>Order Amount: </strong>
          {{ order.totalAmount | currency : "INR" }}
        </p>

        <p class="card-text">
          <strong>Shipping Address: </strong> {{ order.customer.address }}
        </p>
        <p class="card-text">
          <strong>Billing Address: </strong> {{ order.customer.billingAddress }}
        </p>
        <li *ngFor="let item of order.items">
          {{ item.pname }} ({{ item.ram }}, {{ item.disksize }}) x
          {{ item.quantity }} - {{ item.psp | currency : "INR" }}
        </li>
        <div class="d-flex justify-content-center">
          <!-- <button class="btn btn-sm btn-primary" (click)="editOrder(order)">
            <i class="bi bi-pencil-square"></i>
          </button> -->
          <button
            class="btn btn-sm btn-danger ms-2"
            *ngIf="loggedInUser?.role === 'admin'"
            (click)="deleteOrders(order.id)"
          >
            <i class="bi bi-trash"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
